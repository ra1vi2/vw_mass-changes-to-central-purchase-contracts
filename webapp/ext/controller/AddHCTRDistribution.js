/*
 * Copyright (C) 2009-2021 SAP SE or an SAP affiliate company. All rights reserved.
 */
sap.ui.define(["ui/s2p/mm/cntrl/ctrmass/update/ext/model/formatter"],function(f){"use strict";var A={formatter:f,enableSimulationFeature:function(){this.getView().byId("DialogSimulateBtn").setVisible(true);},onPressAddItmDist:function(){var v=this.getView();var a;a=v.byId("AddHCTRItemDistribution");if(!a){a=sap.ui.xmlfragment(v.getId(),"ui.s2p.mm.cntrl.ctrmass.update.ext.fragment.AddHCTRItemDistribution",this);v.addDependent(a);}this.getOwnerComponent().getModel().metadataLoaded().then(this.onMetadataLoadedOfSetNewValueHeaderModel.bind(this,a));a.getContent()[1].getGroups()[1].getGroupElements()[5].setLabel(this.oBundleText.getText("PurchaserNote"));this.byId("ProcmtHubCompanyCodeGroupHierGroupElement").setLabel("Company Code Group");var e=this.AddHCTRDistribution.enableSimulationFeature.bind(this);e();a.open();this.fieldLength=v.getModel().getMetaModel().getODataEntityType("MM_PUR_CNTRLCTRMASS_UPDT_SRV.C_CPurConHierItmDistrMassUpdtType");this.setAffectedDocumentsCount();},onPressAddHdrDist:function(){var v=this.getView();var a;a=v.byId("AddHCTRHeaderDistribution");if(!a){a=sap.ui.xmlfragment(v.getId(),"ui.s2p.mm.cntrl.ctrmass.update.ext.fragment.AddHCTRHeaderDistribution",this);v.addDependent(a);}this.getOwnerComponent().getModel().metadataLoaded().then(this.onMetadataLoadedOfSetNewValueHeaderModel.bind(this,a));a.getContent()[1].getGroups()[1].getGroupElements()[5].setLabel(this.oBundleText.getText("PurchaserNote"));this.byId("ProcmtHubCompanyCodeGroupHierGroupElement").setLabel("Company Code Group");var e=this.AddHCTRDistribution.enableSimulationFeature.bind(this);e();a.open();this.fieldLength=v.getModel().getMetaModel().getODataEntityType("MM_PUR_CNTRLCTRMASS_UPDT_SRV.C_CPurConHierHdrDistrMassUpdtType");this.setAffectedDocumentsCount();},validateHCTRPlant:function(e){var m=this.getView().getModel().getMetaModel().getODataProperty(this.fieldLength,"Plant").maxLength;this.companyCodeChanged="";this.PlantChanged="";var t=this;var n,v,V,a,b;var C=this.getView().byId("ProcmtHubCompanyCode").getValue();if(e){n=e.getParameter("newValue");v=e.getParameter("validated");this.PlantChanged="X";}else{n=this.getView().byId("Plant").getValue();this.companyCodeChanged="X";}if(n.length<=Number(m)&&n!==undefined&&n!==""){if(v){a=t.AddHCTRDistribution.enableApplyChange.bind(t);a("Plant");b=t.AddHCTRDistribution.validateStorageLocation.bind(t);b();}else{var F=[];var M=this.getView().getModel();var u="/C_ProcmtHubPlantVH";var U=new sap.ui.model.Filter({path:"ProcmtHubPlant",operator:sap.ui.model.FilterOperator.EQ,value1:n});F.push(U);U=new sap.ui.model.Filter({path:"ProcmtHubCompanyCode",operator:sap.ui.model.FilterOperator.EQ,value1:C});F.push(U);if(t.ProcurementHubSourceSystem){U=new sap.ui.model.Filter({path:"ProcurementHubSourceSystem",operator:sap.ui.model.FilterOperator.EQ,value1:t.ProcurementHubSourceSystem});F.push(U);}M.read(u,{filters:F,success:function(r){if(r&&r.results){if(r.results.length===0){var s=t.MandateFieldChanged.indexOf("Plant");var c=t.nonMandateFieldChanged.indexOf("Plant");if(s>-1){t.MandateFieldChanged.splice(s,1);}else if(c>-1){t.nonMandateFieldChanged.splice(c,1);}t.getView().byId("DialogApplyBtn").setEnabled(false);t.getView().byId("DialogSimulateBtn").setEnabled(false);if(t.getView().byId("Plant").getMandatory()===true){var d=t.AddHCTRDistribution.dependendsofMandateFields.bind(t);d();}t.getView().byId("Plant").setValueState("Error");V=t.ValueStateErrorFields.indexOf("Plant");if(V<0){t.ValueStateErrorFields.push("Plant");}var g;if(t.companyCodeChanged&&t.companyCodeChanged==="X"){g=t.oBundleText.getText("plantCompanyCodeError");}else{g=t.oBundleText.getText("plantMsg");}t.getView().byId("Plant").setValueStateText(g);}else{V=t.ValueStateErrorFields.indexOf("Plant");t.getView().byId("Plant").setValueState("None");if(V>-1){t.ValueStateErrorFields.splice(V,1);}a=t.AddHCTRDistribution.enableApplyChange.bind(t);a("Plant");b=t.AddHCTRDistribution.validateStorageLocation.bind(t);b();}}},error:function(E){}});}}else{var s=t.MandateFieldChanged.indexOf("Plant");var c=t.nonMandateFieldChanged.indexOf("Plant");if(s>-1){t.MandateFieldChanged.splice(s,1);t.getView().byId("DialogApplyBtn").setEnabled(false);t.getView().byId("DialogSimulateBtn").setEnabled(false);var d=t.AddHCTRDistribution.dependendsofMandateFields.bind(t);d();t.getView().byId("Plant").setValueState("Error");V=t.ValueStateErrorFields.indexOf("Plant");if(V<0){t.ValueStateErrorFields.push("Plant");}var g;if(t.companyCodeChanged&&t.companyCodeChanged==="X"){g=t.oBundleText.getText("plantCompanyCodeError");}else{g=t.oBundleText.getText("plantMsg");}t.getView().byId("Plant").setValueStateText(g);}else if(c>-1){t.nonMandateFieldChanged.splice(c,1);if(n.length>0){V=t.ValueStateErrorFields.indexOf("Plant");if(V<0){t.ValueStateErrorFields.push("Plant");}}else{V=t.ValueStateErrorFields.indexOf("Plant");if(V>-1){t.ValueStateErrorFields.splice(V,1);}}}if((t.MandateFieldChanged.length===5&&t.DocumentCategory==="K"&&t.ValueStateErrorFields.length===0)||(t.MandateFieldChanged.length===7&&t.DocumentCategory==="L"&&t.ValueStateErrorFields.length===0)){t.getView().byId("DialogApplyBtn").setEnabled(true);t.getView().byId("DialogSimulateBtn").setEnabled(true);t.getView().byId("PurgDocNoteText").setEnabled(true);t.getView().byId("PurchasingDocVersionReasonCode").setEnabled(true);}else{t.getView().byId("DialogApplyBtn").setEnabled(false);t.getView().byId("DialogSimulateBtn").setEnabled(false);var d=t.AddHCTRDistribution.dependendsofMandateFields.bind(t);d();}}},validateHCTRPurchasingOrg:function(e){var m=this.getView().getModel().getMetaModel().getODataProperty(this.fieldLength,"ProcmtHubPurchasingOrg").maxLength;this.companyCodeChanged="";var t=this;var n,v,V;if(e){n=e.getParameter("newValue");v=e.getParameter("validated");}else{n=this.getView().byId("ProcmtHubPurchasingOrg").getValue();this.companyCodeChanged="X";}if(n.length<=Number(m)&&n!==undefined&&n!==""){if(v){var a=t.AddHCTRDistribution.enableApplyChange.bind(t);a("ProcmtHubPurchasingOrg");}else{var F=[];var M=this.getView().getModel();var u="/C_ProcmtHubPurgOrgVH";var U=new sap.ui.model.Filter({path:"ProcmtHubPurchasingOrg",operator:sap.ui.model.FilterOperator.EQ,value1:n});F.push(U);if(t.ProcurementHubSourceSystem){U=new sap.ui.model.Filter({path:"ProcurementHubSourceSystem",operator:sap.ui.model.FilterOperator.EQ,value1:t.ProcurementHubSourceSystem});F.push(U);}M.read(u,{filters:F,success:function(r){if(r&&r.results){if(r.results.length===0){t.getView().byId("DialogApplyBtn").setEnabled(false);t.getView().byId("DialogSimulateBtn").setEnabled(false);var d=t.AddHCTRDistribution.dependendsofMandateFields.bind(t);d();var s=t.MandateFieldChanged.indexOf("ProcmtHubPurchasingOrg");if(s>-1){t.MandateFieldChanged.splice(s,1);}t.getView().byId("ProcmtHubPurchasingOrg").setValueState("Error");V=t.ValueStateErrorFields.indexOf("ProcmtHubPurchasingOrg");if(V<0){t.ValueStateErrorFields.push("ProcmtHubPurchasingOrg");}var b;if(t.companyCodeChanged&&t.companyCodeChanged==="X"){b=t.oBundleText.getText("PurchOrgCompanyCodeError");}else{b=t.oBundleText.getText("purchOrgMsg");}t.getView().byId("ProcmtHubPurchasingOrg").setValueStateText(b);}else{t.getView().byId("ProcmtHubPurchasingOrg").setValueState("None");V=t.ValueStateErrorFields.indexOf("ProcmtHubPurchasingOrg");if(V>-1){t.ValueStateErrorFields.splice(V,1);}a=t.AddHCTRDistribution.enableApplyChange.bind(t);a("ProcmtHubPurchasingOrg");}}},error:function(E){}});}}else{t.getView().byId("DialogApplyBtn").setEnabled(false);t.getView().byId("DialogSimulateBtn").setEnabled(false);var d=t.AddHCTRDistribution.dependendsofMandateFields.bind(t);d();var s=t.MandateFieldChanged.indexOf("ProcmtHubPurchasingOrg");if(s>-1){t.MandateFieldChanged.splice(s,1);}t.getView().byId("ProcmtHubPurchasingOrg").setValueState("Error");V=t.ValueStateErrorFields.indexOf("ProcmtHubPurchasingOrg");if(V<0){t.ValueStateErrorFields.push("ProcmtHubPurchasingOrg");}var b;if(t.companyCodeChanged&&t.companyCodeChanged==="X"){b=t.oBundleText.getText("PurchOrgCompanyCodeError");}else{b=t.oBundleText.getText("purchOrgMsg");}t.getView().byId("ProcmtHubPurchasingOrg").setValueStateText(b);}},validateHCTRPurchasingGrp:function(e){var m=this.getView().getModel().getMetaModel().getODataProperty(this.fieldLength,"ProcmtHubPurchasingGroup").maxLength;this.companyCodeChanged="";var n,v,V,a;if(e){n=e.getParameter("newValue");v=e.getParameter("validated");}else{n=this.getView().byId("ProcmtHubPurchasingGroup").getValue();this.companyCodeChanged="X";}var t=this;if(n.length<=Number(m)&&n!==undefined&&n!==""){if(v){a=t.AddHCTRDistribution.enableApplyChange.bind(t);a("ProcmtHubPurchasingGroup");}else{var F=[];var M=this.getView().getModel();var u="/C_ProcmtHubCntrlContrPurgGrpVH";var U=new sap.ui.model.Filter({path:"PurchasingGroup",operator:sap.ui.model.FilterOperator.EQ,value1:n});F.push(U);if(t.ProcurementHubSourceSystem){U=new sap.ui.model.Filter({path:"ProcurementHubSourceSystem",operator:sap.ui.model.FilterOperator.EQ,value1:t.ProcurementHubSourceSystem});F.push(U);}M.read(u,{filters:F,success:function(r){if(r&&r.results){if(r.results.length===0){t.getView().byId("DialogApplyBtn").setEnabled(false);t.getView().byId("DialogSimulateBtn").setEnabled(false);var d=t.AddHCTRDistribution.dependendsofMandateFields.bind(t);d();var s=t.MandateFieldChanged.indexOf("ProcmtHubPurchasingGroup");if(s>-1){t.MandateFieldChanged.splice(s,1);}t.getView().byId("ProcmtHubPurchasingGroup").setValueState("Error");V=t.ValueStateErrorFields.indexOf("ProcmtHubPurchasingGroup");if(V<0){t.ValueStateErrorFields.push("ProcmtHubPurchasingGroup");}var b;if(t.companyCodeChanged&&t.companyCodeChanged==="X"){b=t.oBundleText.getText("PurchGrpCompanyCodeError");}else{b=t.oBundleText.getText("purchGrpMsg");}t.getView().byId("ProcmtHubPurchasingGroup").setValueStateText(b);}else{t.getView().byId("ProcmtHubPurchasingGroup").setValueState("None");V=t.ValueStateErrorFields.indexOf("ProcmtHubPurchasingGroup",t);if(V>-1){t.ValueStateErrorFields.splice(V,1);}a=t.AddHCTRDistribution.enableApplyChange.bind(t);a("ProcmtHubPurchasingGroup");}}},error:function(E){}});}}else{t.getView().byId("DialogApplyBtn").setEnabled(false);t.getView().byId("DialogSimulateBtn").setEnabled(false);var d=t.AddHCTRDistribution.dependendsofMandateFields.bind(t);d();var s=t.MandateFieldChanged.indexOf("ProcmtHubPurchasingGroup");if(s>-1){t.MandateFieldChanged.splice(s,1);}t.getView().byId("ProcmtHubPurchasingGroup").setValueState("Error");V=t.ValueStateErrorFields.indexOf("ProcmtHubPurchasingGroup");if(V<0){t.ValueStateErrorFields.push("ProcmtHubPurchasingGroup");}var b;if(t.companyCodeChanged&&t.companyCodeChanged==="X"){b=t.oBundleText.getText("PurchGrpCompanyCodeError");}else{b=t.oBundleText.getText("purchGrpMsg");}t.getView().byId("ProcmtHubPurchasingGroup").setValueStateText(b);}},validateDependentFieldsOfHCTR:function(){var P,a,S,b,c;P=this.getView().byId("Plant").getValue();if(P){var d=this.AddHCTRDistribution.validatePlant.bind(this);d();}a=this.getView().byId("ProcmtHubPurchasingOrg").getValue();if(a){var v=this.AddHCTRDistribution.validatePurchasingOrg.bind(this);v();}b=this.getView().byId("ProcmtHubPurchasingGroup").getValue();if(b){var e=this.AddHCTRDistribution.validatePurchasingGrp.bind(this);e();}S=this.getView().byId("StorageLocation").getValue();if(S){var g=this.AddHCTRDistribution.validateStorageLocation.bind(this);g();}c=this.getView().byId("PurchasingDocumentType").getValue();if(c){var h=this.AddHCTRDistribution.validatePurchasingDocumentType.bind(this);h();}},hideDependentfieldsOfHCTR:function(){var s;this.getView().byId("Plant").setEditable(false);this.getView().byId("Plant").setValue("");s=this.MandateFieldChanged.indexOf("Plant");if(s>-1){this.MandateFieldChanged.splice(s,1);}this.getView().byId("ProcmtHubPurchasingOrg").setEditable(false);this.getView().byId("ProcmtHubPurchasingOrg").setValue("");s=this.MandateFieldChanged.indexOf("ProcmtHubPurchasingOrg");if(s>-1){this.MandateFieldChanged.splice(s,1);}this.getView().byId("ProcmtHubPurchasingGroup").setEditable(false);this.getView().byId("ProcmtHubPurchasingGroup").setValue("");s=this.MandateFieldChanged.indexOf("ProcmtHubPurchasingGroup");if(s>-1){this.MandateFieldChanged.splice(s,1);}this.getView().byId("StorageLocation").setEditable(false);this.getView().byId("StorageLocation").setValue("");s=this.MandateFieldChanged.indexOf("StorageLocation");if(s>-1){this.MandateFieldChanged.splice(s,1);}this.getView().byId("PurchasingDocumentType").setEditable(false);this.getView().byId("PurchasingDocumentType").setValue("");s=this.MandateFieldChanged.indexOf("PurchasingDocumentType");if(s>-1){this.MandateFieldChanged.splice(s,1);}},validateHCTRCompanyCode:function(e){var m=this.getView().getModel().getMetaModel().getODataProperty(this.fieldLength,"ProcmtHubCompanyCode").maxLength;var t=this;var V,a,v;var b=e.getParameter("validated");var n=e.getParameter("newValue");if(n.length<=Number(m)&&n!==undefined&&n!==""){this.getView().byId("DialogResetBtn").setEnabled(true);if(b){t.getView().byId("Plant").setEditable(true);t.getView().byId("ProcmtHubPurchasingGroup").setEditable(true);t.getView().byId("ProcmtHubPurchasingOrg").setEditable(true);if(t.getView().byId("ProcmtHubPurgDocItmCategory").getValue()==="L"){t.getView().byId("PurchasingDocumentType").setEditable(true);}t.getView().byId("StorageLocation").setEditable(true);a=t.AddHCTRDistribution.enableApplyChange.bind(t);a("ProcmtHubCompanyCode");v=t.AddHCTRDistribution.validateDependentFieldsOfHCTR.bind(t);v();}else{var F=[];var M=this.getView().getModel();var u="/C_ProcmtHubGroupCompanyCodeVH";var U=new sap.ui.model.Filter({path:"ProcmtHubCompanyCode",operator:sap.ui.model.FilterOperator.EQ,value1:n});F.push(U);M.read(u,{filters:F,success:function(r){if(r&&r.results){if(r.results.length===0){t.ProcurementHubSourceSystem="";t.ProcmtHubCompanyCodeGroupingID="";t.getView().byId("ProcmtHubCompanyCodeGroupingID").setValue(t.ProcmtHubCompanyCodeGroupingID);var h=t.AddHCTRDistribution.hideDependentfieldsOfHCTR.bind(t);h();t.getView().byId("DialogApplyBtn").setEnabled(false);t.getView().byId("DialogSimulateBtn").setEnabled(false);var d=t.AddHCTRDistribution.dependendsofMandateFields.bind(t);d();var s=t.MandateFieldChanged.indexOf("ProcmtHubCompanyCode");if(s>-1){t.MandateFieldChanged.splice(s,1);}t.getView().byId("ProcmtHubCompanyCode").setValueState("Error");V=t.ValueStateErrorFields.indexOf("ProcmtHubCompanyCode");if(V<0){t.ValueStateErrorFields.push("ProcmtHubCompanyCode");}var c=t.oBundleText.getText("companycodeMsg");t.getView().byId("ProcmtHubCompanyCode").setValueStateText(c);}else{t.ProcurementHubSourceSystem=r.results[0].ProcurementHubSourceSystem;t.ProcmtHubCompanyCodeGroupingID=r.results[0].ProcmtHubCompanyCodeGroupingID;t.getView().byId("ProcmtHubCompanyCodeGroupingID").setValue(t.ProcmtHubCompanyCodeGroupingID);t.getView().byId("Plant").setEditable(true);t.getView().byId("ProcmtHubPurchasingGroup").setEditable(true);t.getView().byId("ProcmtHubPurchasingOrg").setEditable(true);if(t.getView().byId("ProcmtHubPurgDocItmCategory").getValue()==="L"){t.getView().byId("PurchasingDocumentType").setEditable(true);}t.getView().byId("StorageLocation").setEditable(true);a=t.AddHCTRDistribution.enableApplyChange.bind(t);a("ProcmtHubCompanyCode");v=t.AddHCTRDistribution.validateDependentFieldsOfHCTR.bind(t);v();}}},error:function(E){}});}}else{if(n.length>0){this.getView().byId("DialogResetBtn").setEnabled(true);}var h=t.AddHCTRDistribution.hideDependentfieldsOfHCTR.bind(t);h();t.getView().byId("DialogApplyBtn").setEnabled(false);t.getView().byId("DialogSimulateBtn").setEnabled(false);var d=t.AddHCTRDistribution.dependendsofMandateFields.bind(t);d();var s=t.MandateFieldChanged.indexOf("ProcmtHubCompanyCode");if(s>-1){t.MandateFieldChanged.splice(s,1);}t.getView().byId("ProcmtHubCompanyCode").setValueState("Error");V=t.ValueStateErrorFields.indexOf("ProcmtHubCompanyCode");if(V<0){t.ValueStateErrorFields.push("ProcmtHubCompanyCode");}var c=t.oBundleText.getText("companycodeMsg");t.getView().byId("ProcmtHubCompanyCode").setValueStateText(c);}},validateHCTRItmCategory:function(e){var V;var n=e.getParameter("newValue");this.getView().byId("DialogResetBtn").setEnabled(true);if(n==="L"&&this.getView().byId("ProcmtHubCompanyCode").getValue()){this.getView().byId("PurchasingDocumentType").setEditable(true);}else{this.getView().byId("PurchasingDocumentType").setEditable(false);var O=this.getView().byId("PurchasingDocumentType").getValue();if(O){this.getView().byId("PurchasingDocumentType").setValue("");}var s=this.MandateFieldChanged.indexOf("PurchasingDocumentType");if(s>-1){this.MandateFieldChanged.splice(s,1);}}if(n==="L"||n==="K"){var c=this.getView().byId("ProcmtHubPurgDocItmCategory").getValue();var P=this.getView().byId("Plant").getValue();var a=this.MandateFieldChanged.indexOf("Plant");var b=this.nonMandateFieldChanged.indexOf("Plant");if(c==="L"&&b>-1&&P){this.nonMandateFieldChanged.splice(b,1);this.MandateFieldChanged.push("Plant");}else if(c==="K"&&a>-1&&P){this.MandateFieldChanged.splice(a,1);this.nonMandateFieldChanged.push("Plant");}var d=this.getView().byId("PurchasingDocumentType").getValue();a=this.MandateFieldChanged.indexOf("PurchasingDocumentType");if(c==="K"&&a>-1&&d){this.MandateFieldChanged.splice(a,1);this.getView().byId("PurchasingDocumentType").setValue("");}var g=this.AddHCTRDistribution.enableApplyChange.bind(this);g("ProcmtHubPurgDocItmCategory");}else{this.getView().byId("ProcmtHubPurgDocItmCategory").setValueState("Error");V=this.ValueStateErrorFields.indexOf("ProcmtHubPurgDocItmCategory");if(V<0){this.ValueStateErrorFields.push("ProcmtHubPurgDocItmCategory");}var h=this.oBundleText.getText("documentCatMsg");this.getView().byId("ProcmtHubPurgDocItmCategory").setValueStateText(h);this.getView().byId("DialogApplyBtn").setEnabled(false);this.getView().byId("DialogSimulateBtn").setEnabled(false);var i=this.AddHCTRDistribution.dependendsofMandateFields.bind(this);i();s=this.MandateFieldChanged.indexOf("ProcmtHubPurgDocItmCategory");if(s>-1){this.MandateFieldChanged.splice(s,1);}}},validateHCTRDistributionPercentage:function(e){var V;this.getView().byId("DialogResetBtn").setEnabled(true);var n=e.getParameter("newValue");var a=this.getView().byId("CntrlPurContrDistributionPct").getValueState();if(n!==""&&parseFloat(n)<=100&&parseFloat(n)>=0&&a!==sap.ui.core.ValueState.Error){var b=this.AddHCTRDistribution.enableApplyChange.bind(this);b("CntrlPurContrDistributionPct");}else{this.getView().byId("CntrlPurContrDistributionPct").setValueState("Error");V=this.ValueStateErrorFields.indexOf("CntrlPurContrDistributionPct");if(V<0){this.ValueStateErrorFields.push("CntrlPurContrDistributionPct");}var c=this.oBundleText.getText("distPercntError");this.getView().byId("CntrlPurContrDistributionPct").setValueStateText(c);this.getView().byId("DialogApplyBtn").setEnabled(false);this.getView().byId("DialogSimulateBtn").setEnabled(false);var d=this.AddHCTRDistribution.dependendsofMandateFields.bind(this);d();var s=this.MandateFieldChanged.indexOf("CntrlPurContrDistributionPct");if(s>-1){this.MandateFieldChanged.splice(s,1);}}},validateHCTRStorageLocation:function(e){var m=this.getView().getModel().getMetaModel().getODataProperty(this.fieldLength,"StorageLocation").maxLength;this.companyCodeChanged="";var t=this;var n,v,p,a,b,V,c;if(e){n=e.getParameter("newValue");v=e.getParameter("validated");}else{n=this.getView().byId("StorageLocation").getValue();this.companyCodeChanged="X";}if(n.length<=Number(m)&&n!==undefined&&n!==""){if(v){p=t.getView().byId("Plant").getValue();a=t.MandateFieldChanged.indexOf("Plant");b=t.nonMandateFieldChanged.indexOf("Plant");if(p&&a<0&&t.DocumentCategory==="L"){t.MandateFieldChanged.push("Plant");}else if(p&&b<0){t.nonMandateFieldChanged.push("Plant");}c=t.AddHCTRDistribution.enableApplyChange.bind(t);c("StorageLocation");}else{var F=[];var u;var M=this.getView().getModel();var d="/C_ProcmtHubStorageLocationVH";var P=this.getView().byId("Plant").getValue();u=new sap.ui.model.Filter({path:"StorageLocation",operator:sap.ui.model.FilterOperator.EQ,value1:n});F.push(u);if(P){u=new sap.ui.model.Filter({path:"Plant",operator:sap.ui.model.FilterOperator.EQ,value1:P});F.push(u);}if(t.ProcurementHubSourceSystem){u=new sap.ui.model.Filter({path:"ProcurementHubSourceSystem",operator:sap.ui.model.FilterOperator.EQ,value1:t.ProcurementHubSourceSystem});F.push(u);}M.read(d,{filters:F,success:function(r){if(r&&r.results){if(r.results.length===0){t.getView().byId("DialogApplyBtn").setEnabled(false);t.getView().byId("DialogSimulateBtn").setEnabled(false);var g=t.nonMandateFieldChanged.indexOf("StorageLocation");if(g>-1){t.nonMandateFieldChanged.splice(g,1);}t.getView().byId("StorageLocation").setValueState("Error");V=t.ValueStateErrorFields.indexOf("StorageLocation");if(V<0){t.ValueStateErrorFields.push("StorageLocation");}var h;if(t.companyCodeChanged&&t.companyCodeChanged==="X"){h=t.oBundleText.getText("StorageLocCompanyCodeError");}else{h=t.oBundleText.getText("storageLocationMsg");}t.getView().byId("StorageLocation").setValueStateText(h);}else{t.getView().byId("StorageLocation").setValueState("None");V=t.ValueStateErrorFields.indexOf("StorageLocation");if(V>-1){t.ValueStateErrorFields.splice(V,1);}p=t.getView().byId("Plant").getValue();a=t.MandateFieldChanged.indexOf("Plant");b=t.nonMandateFieldChanged.indexOf("Plant");if(p&&a<0&&t.DocumentCategory==="L"){t.MandateFieldChanged.push("Plant");}else if(p&&b<0&&t.DocumentCategory==="K"){t.nonMandateFieldChanged.push("Plant");}c=t.AddHCTRDistribution.enableApplyChange.bind(t);c("StorageLocation");}}},error:function(E){}});}}else{if(n.length>0){V=t.ValueStateErrorFields.indexOf("StorageLocation");if(V<0){t.ValueStateErrorFields.push("StorageLocation");}}else{V=t.ValueStateErrorFields.indexOf("StorageLocation");if(V>-1){t.ValueStateErrorFields.splice(V,1);}}var g=t.nonMandateFieldChanged.indexOf("StorageLocation");if(g>-1){t.nonMandateFieldChanged.splice(g,1);}if((t.MandateFieldChanged.length===5&&t.DocumentCategory==="K"&&t.ValueStateErrorFields.length===0)||(t.MandateFieldChanged.length===7&&t.DocumentCategory==="L"&&t.ValueStateErrorFields.length===0)){t.getView().byId("DialogApplyBtn").setEnabled(true);t.getView().byId("DialogSimulateBtn").setEnabled(true);t.getView().byId("PurgDocNoteText").setEnabled(true);t.getView().byId("PurchasingDocVersionReasonCode").setEnabled(true);}else{t.getView().byId("DialogApplyBtn").setEnabled(false);t.getView().byId("DialogSimulateBtn").setEnabled(false);}}},validateHCTRPurchasingInfoRecordUpdateCode:function(e){var m=this.getView().getModel().getMetaModel().getODataProperty(this.fieldLength,"PurchasingInfoRecordUpdateCode").maxLength;this.companyCodeChanged="";var t=this,V,a;var v=e.getParameter("validated");var n=e.getParameter("newValue");if(n.length>0){this.getView().byId("DialogResetBtn").setEnabled(true);}if(n.length<=Number(m)&&n!==undefined&&n!==""){this.getView().byId("DialogResetBtn").setEnabled(true);if(v){a=t.AddHCTRDistribution.enableApplyChange.bind(t);a("PurchasingInfoRecordUpdateCode");}else{var F=[];var M=this.getView().getModel();var u="/I_PurgInfoRecordUpdateCode";var U=new sap.ui.model.Filter({path:"PurchasingInfoRecordUpdateCode",operator:sap.ui.model.FilterOperator.EQ,value1:n});F.push(U);M.read(u,{filters:F,success:function(r){if(r&&r.results){if(r.results.length===0){t.getView().byId("DialogApplyBtn").setEnabled(false);t.getView().byId("DialogSimulateBtn").setEnabled(false);var b=t.nonMandateFieldChanged.indexOf("PurchasingInfoRecordUpdateCode");if(b>-1){t.nonMandateFieldChanged.splice(b,1);}t.getView().byId("PurchasingInfoRecordUpdateCode").setValueState("Error");V=t.ValueStateErrorFields.indexOf("PurchasingInfoRecordUpdateCode");if(V<0){t.ValueStateErrorFields.push("PurchasingInfoRecordUpdateCode");}var c=t.oBundleText.getText("infoRecordUpdateMsg");t.getView().byId("PurchasingInfoRecordUpdateCode").setValueStateText(c);}else{t.getView().byId("PurchasingInfoRecordUpdateCode").setValueState("None");V=t.ValueStateErrorFields.indexOf("PurchasingInfoRecordUpdateCode");if(V>-1){t.ValueStateErrorFields.splice(V,1);}a=t.AddHCTRDistribution.enableApplyChange.bind(t);a("PurchasingInfoRecordUpdateCode");}}},error:function(E){}});}}else{if(n.length>0){V=t.ValueStateErrorFields.indexOf("PurchasingInfoRecordUpdateCode");if(V<0){t.ValueStateErrorFields.push("PurchasingInfoRecordUpdateCode");}}else{V=t.ValueStateErrorFields.indexOf("PurchasingInfoRecordUpdateCode");if(V>-1){t.ValueStateErrorFields.splice(V,1);}}var b=t.nonMandateFieldChanged.indexOf("PurchasingInfoRecordUpdateCode");if(b>-1){t.nonMandateFieldChanged.splice(b,1);}if((t.MandateFieldChanged.length===5&&t.DocumentCategory==="K"&&t.ValueStateErrorFields.length===0)||(t.MandateFieldChanged.length===7&&t.DocumentCategory==="L"&&t.ValueStateErrorFields.length===0)){t.getView().byId("DialogApplyBtn").setEnabled(true);t.getView().byId("DialogSimulateBtn").setEnabled(true);t.getView().byId("PurgDocNoteText").setEnabled(true);t.getView().byId("PurchasingDocVersionReasonCode").setEnabled(true);}else{t.getView().byId("DialogApplyBtn").setEnabled(false);t.getView().byId("DialogSimulateBtn").setEnabled(false);}}},validateHCTRPurchasingDocVersionReasonCode:function(e){var n=e.getParameters().newValue;var v=this.getView().byId("ui.s2p.mm.cntrl.ctrmass.update::sap.suite.ui.generic.template.ListReport.view.ListReport::C_PurCntrlContrItmMassUpdt--PurchasingDocVersionReasonCode-comboBoxEdit").getValue();if(n===""&&v!==""){this.getView().byId("PurchasingDocVersionReasonCode").setValueState("Error");this.getView().byId("PurchasingDocVersionReasonCode").setValueStateText(this.oBundleText.getText("ReasonCodeErrText"));this.getView().byId("DialogApplyBtn").setEnabled(false);this.getView().byId("DialogSimulateBtn").setEnabled(false);this.ValueStateErrorFields.push("PurchasingDocVersionReasonCode");}else{this.getView().byId("PurchasingDocVersionReasonCode").setValueState("None");this.getView().byId("PurchasingDocVersionReasonCode").setValueStateText("");var V=this.ValueStateErrorFields.indexOf("PurchasingDocVersionReasonCode");if(V>-1){this.ValueStateErrorFields.splice(V,1);}if(this.ValueStateErrorFields.length<1){this.getView().byId("DialogApplyBtn").setEnabled(true);this.getView().byId("DialogSimulateBtn").setEnabled(true);}}},validateHCTRPaymentTerms:function(e){var m=this.getView().getModel().getMetaModel().getODataProperty(this.fieldLength,"PaymentTerms").maxLength;var t=this;var V,a;var v=e.getParameter("validated");var n=e.getParameter("newValue");if(n.length>0){this.getView().byId("DialogResetBtn").setEnabled(true);}if(n.length<=Number(m)&&n!==undefined&&n!==""){this.getView().byId("DialogResetBtn").setEnabled(true);if(v){a=t.AddHCTRDistribution.enableApplyChange.bind(t);a("PaymentTerms");}else{var F=[];var M=this.getView().getModel();var u="/I_PaymentTerms";var U=new sap.ui.model.Filter({path:"PaymentTerms",operator:sap.ui.model.FilterOperator.EQ,value1:n});F.push(U);M.read(u,{filters:F,success:function(r){if(r&&r.results){if(r.results.length===0){t.getView().byId("DialogApplyBtn").setEnabled(false);t.getView().byId("DialogSimulateBtn").setEnabled(false);var b=t.nonMandateFieldChanged.indexOf("PaymentTerms");if(b>-1){t.nonMandateFieldChanged.splice(b,1);}t.getView().byId("PaymentTerms").setValueState("Error");V=t.ValueStateErrorFields.indexOf("PaymentTerms");if(V<0){t.ValueStateErrorFields.push("PaymentTerms");}var c=t.oBundleText.getText("paymentTermsMsg");t.getView().byId("PaymentTerms").setValueStateText(c);}else{t.getView().byId("PurchasingInfoRecordUpdateCode").setValueState("None");V=t.ValueStateErrorFields.indexOf("PurchasingInfoRecordUpdateCode");if(V>-1){t.ValueStateErrorFields.splice(V,1);}a=t.AddHCTRDistribution.enableApplyChange.bind(t);a("PaymentTerms");}}},error:function(E){}});}}else{if(n.length>0){V=t.ValueStateErrorFields.indexOf("PaymentTerms");if(V<0){t.ValueStateErrorFields.push("PaymentTerms");}}else{V=t.ValueStateErrorFields.indexOf("PaymentTerms");if(V>-1){t.ValueStateErrorFields.splice(V,1);}}var b=t.nonMandateFieldChanged.indexOf("PaymentTerms");if(b>-1){t.nonMandateFieldChanged.splice(b,1);}if((t.MandateFieldChanged.length===5&&t.DocumentCategory==="K"&&t.ValueStateErrorFields.length===0)||(t.MandateFieldChanged.length===7&&t.DocumentCategory==="L"&&t.ValueStateErrorFields.length===0)){t.getView().byId("DialogApplyBtn").setEnabled(true);t.getView().byId("DialogSimulateBtn").setEnabled(true);t.getView().byId("PurgDocNoteText").setEnabled(true);t.getView().byId("PurchasingDocVersionReasonCode").setEnabled(true);}else{t.getView().byId("DialogApplyBtn").setEnabled(false);t.getView().byId("DialogSimulateBtn").setEnabled(false);}}},validateHCTRPurchasingDocumentType:function(e){var m=this.getView().getModel().getMetaModel().getODataProperty(this.fieldLength,"PurchasingDocumentType").maxLength;this.companyCodeChanged="";var t=this;var n,v,V,a;if(e){n=e.getParameter("newValue");v=e.getParameter("validated");}else{n=this.getView().byId("PurchasingDocumentType").getValue();this.companyCodeChanged="X";}if(n.length<=Number(m)&&n!==undefined&&n!==""){this.getView().byId("DialogResetBtn").setEnabled(true);t.getView().byId("PurgDocNoteText").setEnabled(true);t.getView().byId("PurchasingDocVersionReasonCode").setEnabled(true);if(v){a=t.AddHCTRDistribution.enableApplyChange.bind(t);a("PurchasingDocumentType");}else{var F=[];var M=this.getView().getModel();var u="/C_ProcmtHubSchedgAgrmtTypeVH";var U=new sap.ui.model.Filter({path:"PurchasingDocumentType",operator:sap.ui.model.FilterOperator.EQ,value1:n});F.push(U);if(t.ProcurementHubSourceSystem){U=new sap.ui.model.Filter({path:"ProcurementHubSourceSystem",operator:sap.ui.model.FilterOperator.EQ,value1:t.ProcurementHubSourceSystem});F.push(U);}M.read(u,{filters:F,success:function(r){if(r&&r.results){if(r.results.length===0){t.getView().byId("DialogApplyBtn").setEnabled(false);t.getView().byId("DialogSimulateBtn").setEnabled(false);var d=t.AddHCTRDistribution.dependendsofMandateFields.bind(t);d();var b=t.MandateFieldChanged.indexOf("PurchasingDocumentType");if(b>-1){t.MandateFieldChanged.splice(b,1);}t.getView().byId("PurchasingDocumentType").setValueState("Error");V=t.ValueStateErrorFields.indexOf("PurchasingDocumentType");if(V<0){t.ValueStateErrorFields.push("PurchasingDocumentType");}var c;if(t.companyCodeChanged&&t.companyCodeChanged==="X"){c=t.oBundleText.getText("outlAgrmntCompanyCodeError");}else{c=t.oBundleText.getText("outlineAgrmntTypMsg");}t.getView().byId("PurchasingDocumentType").setValueStateText(c);}else{t.getView().byId("PurchasingDocumentType").setValueState("None");V=t.ValueStateErrorFields.indexOf("PurchasingDocumentType");if(V>-1){t.ValueStateErrorFields.splice(V,1);}a=t.AddHCTRDistribution.enableApplyChange.bind(t);a("PurchasingDocumentType");}}},error:function(E){}});}}else{var b=t.MandateFieldChanged.indexOf("PurchasingDocumentType");if(b>-1){t.MandateFieldChanged.splice(b,1);}var c;if(t.companyCodeChanged&&t.companyCodeChanged==="X"){c=t.oBundleText.getText("outlAgrmntCompanyCodeError");}else{c=t.oBundleText.getText("outlineAgrmntTypMsg");}t.getView().byId("PurchasingDocumentType").setValueStateText(c);if((t.MandateFieldChanged.length===5&&t.DocumentCategory==="K"&&t.ValueStateErrorFields.length===0)||(t.MandateFieldChanged.length===7&&t.DocumentCategory==="L"&&t.ValueStateErrorFields.length===0)){t.getView().byId("DialogApplyBtn").setEnabled(true);t.getView().byId("DialogSimulateBtn").setEnabled(true);t.getView().byId("PurgDocNoteText").setEnabled(true);t.getView().byId("PurchasingDocVersionReasonCode").setEnabled(true);}else{t.getView().byId("DialogApplyBtn").setEnabled(false);t.getView().byId("DialogSimulateBtn").setEnabled(false);var d=t.AddHCTRDistribution.dependendsofMandateFields.bind(t);d();}}},onReset:function(e){var r;var s=e.getSource().getParent().getId();this.MandateFieldChanged=[];this.nonMandateFieldChanged=[];this.ValueStateErrorFields=[];this.DocumentCategory="";this.getView().byId("DialogApplyBtn").setEnabled(false);this.getView().byId("DialogSimulateBtn").setEnabled(false);var d=this.AddHCTRDistribution.dependendsofMandateFields.bind(this);d();this.getView().byId("DialogResetBtn").setEnabled(false);this.getView().byId("CntrlPurContrDistributionPct").setValue(parseFloat(Number(0)).toFixed(3));if(s==="ui.s2p.mm.cntrl.ctrmass.update::sap.suite.ui.generic.template.ListReport.view.ListReport::C_PurCntrlContrItmMassUpdt--AddHCTRItemDistribution"){this.getView().byId("smartFormHCTRItemDistribution").getModel().resetChanges();r=this.AddHCTRDistribution.resetSamrtFormMetadat.bind(this);r("smartFormHCTRItemDistribution");}else if(s==="ui.s2p.mm.cntrl.ctrmass.update::sap.suite.ui.generic.template.ListReport.view.ListReport::C_PurCntrlContrItmMassUpdt--AddHCTRHeaderDistribution"){this.getView().byId("smartFormHCTRHeaderDistribution").getModel().resetChanges();r=this.AddHCTRDistribution.resetSamrtFormMetadat.bind(this);r("smartFormHCTRHeaderDistribution");}},resetSamrtFormMetadat:function(s){var a;for(var o=0;o<2;o++){for(var i=0;i<5;i++){this.byId(s).getGroups()[o].getGroupElements()[i].getElements()[0].setValueState("None");a=this.byId(s).getGroups()[o].getGroupElements()[i].getElements()[0].getBindingInfo("value").parts[0].path;if(a==="PurchasingDocumentType"||a==="ProcmtHubPurchasingGroup"||a==="ProcmtHubPurchasingOrg"||a==="Plant"||a==="StorageLocation"){this.byId(s).getGroups()[o].getGroupElements()[i].getElements()[0].setEditable(false);}}}},onAddHeaderDistDialogClose:function(d){var c=this.getOwnerComponent();var a=c.getModel();var o=this.getView().byId(d);var C=o.getBindingContext();a.deleteCreatedEntry(C);this.AffectedContractsOnAddHdrDist=[];this.AffectedContractsHdrDistCount=undefined;this.MandateFieldChanged=[];this.nonMandateFieldChanged=[];},enableApplyChange:function(a){this.DocumentCategory=this.getView().byId("ProcmtHubPurgDocItmCategory").getValue();var m=this.getView().byId(a).getMandatory();var b=this.getView().byId("DialogApplyBtn");var s=this.getView().byId("DialogSimulateBtn");var r=this.getView().byId("DialogResetBtn");var c,V;if(a==="Plant"&&this.DocumentCategory==="L"){m=true;}else if(a==="Plant"){m=false;}if(m){c=this.MandateFieldChanged.indexOf(a);}else{c=this.nonMandateFieldChanged.indexOf(a);}if(c===-1&&m){this.MandateFieldChanged.push(a);V=this.ValueStateErrorFields.indexOf(a);if(V>-1){this.ValueStateErrorFields.splice(V,1);}}else if(c===-1&&!(m)){this.nonMandateFieldChanged.push(a);V=this.ValueStateErrorFields.indexOf(a);if(V>-1){this.ValueStateErrorFields.splice(V,1);}}if((this.MandateFieldChanged.length===5&&this.DocumentCategory==="K"&&this.ValueStateErrorFields.length===0)||(this.MandateFieldChanged.length===7&&this.DocumentCategory==="L"&&this.ValueStateErrorFields.length===0)){b.setEnabled(true);s.setEnabled(true);this.getView().byId("PurgDocNoteText").setEnabled(true);this.getView().byId("PurchasingDocVersionReasonCode").setEnabled(true);}else{b.setEnabled(false);s.setEnabled(false);if(this.MandateFieldChanged.length===5&&this.DocumentCategory==="L"){var d=this.AddHCTRDistribution.dependendsofMandateFields.bind(this);d();}}if(this.MandateFieldChanged.length>0||this.nonMandateFieldChanged.length>0){r.setEnabled(true);}else{r.setEnabled(false);}},onCancelDialog:function(e){var s=e.getSource().getParent().getId();this.MandateFieldChanged=[];this.nonMandateFieldChanged=[];this.ValueStateErrorFields=[];this.DocumentCategory="";var d;if(s==="ui.s2p.mm.cntrl.ctrmass.update::sap.suite.ui.generic.template.ListReport.view.ListReport::C_PurCntrlContrItmMassUpdt--AddHCTRHeaderDistribution"){d="AddHCTRHeaderDistribution";}else if(s==="ui.s2p.mm.cntrl.ctrmass.update::sap.suite.ui.generic.template.ListReport.view.ListReport::C_PurCntrlContrItmMassUpdt--AddHCTRItemDistribution"){d="AddHCTRItemDistribution";}if(d){var o=this.AddDistribution.onAddHeaderDistDialogClose.bind(this);o(d);this.getView().byId(d).close();this.getView().byId(d).destroy();}},validateHCTRPurchaserNote:function(e){if(e.getParameters().value.length>5000){e.getSource().setValueState("Error");e.getSource().setValueStateText(this.oBundleText.getText("PurchaserNoteMaxLength"));this.getView().byId("DialogApplyBtn").setEnabled(false);this.getView().byId("DialogSimulateBtn").setEnabled(false);var V=this.ValueStateErrorFields.indexOf("PurgDocNoteText");if(V<0){this.ValueStateErrorFields.push("PurgDocNoteText");}}else{e.getSource().setValueState("None");e.getSource().setValueStateText("");var V=this.ValueStateErrorFields.indexOf("PurgDocNoteText");if(V>-1){this.ValueStateErrorFields.splice(V,1);}if(this.ValueStateErrorFields.length<1){this.getView().byId("DialogApplyBtn").setEnabled(true);this.getView().byId("DialogSimulateBtn").setEnabled(true);}}},dependendsofMandateFields:function(){var V;this.getView().byId("PurchasingDocVersionReasonCode").setValue("");this.getView().byId("PurgDocNoteText").setValue("");this.getView().byId("PurchasingDocVersionReasonCode").setEnabled(false);this.getView().byId("PurgDocNoteText").setEnabled(false);V=this.ValueStateErrorFields.indexOf("PurgDocNoteText");if(V>-1){this.ValueStateErrorFields.splice(V,1);}V=this.ValueStateErrorFields.indexOf("PurchasingDocVersionReasonCode");if(V>-1){this.ValueStateErrorFields.splice(V,1);}}};return A;});
